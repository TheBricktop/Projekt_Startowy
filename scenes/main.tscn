[gd_scene load_steps=22 format=3 uid="uid://c1mb3reh2sna2"]

[ext_resource type="PackedScene" uid="uid://caqqa217jtnra" path="res://art/3d/City_Scene.blend" id="1_ct7o4"]
[ext_resource type="Texture2D" uid="uid://cph21yt0xhbd3" path="res://art/2d/256_Grass 01 Simple.png" id="1_j6pm3"]
[ext_resource type="Texture2D" uid="uid://dl2qaq2mm2nnm" path="res://art/2d/256_Grass 02 Blades.png" id="2_umbrl"]
[ext_resource type="PackedScene" uid="uid://dqngcp7qr5dhr" path="res://scenes/player_template.tscn" id="2_yn66j"]
[ext_resource type="PackedScene" uid="uid://jn23g2de5dbg" path="res://scenes/drzwi_area.tscn" id="3_e0d1d"]
[ext_resource type="PackedScene" uid="uid://bokwmibfj0pmk" path="res://art/3d/key.blend" id="4_rjhu0"]
[ext_resource type="Script" path="res://script/Key.gd" id="6_2k43v"]
[ext_resource type="Script" path="res://scenes/Lock.gd" id="6_hj6ip"]
[ext_resource type="Texture2D" uid="uid://dot0ex1d0mjvj" path="res://art/2d/256_Wood Planks 01.png" id="8_3qtlm"]
[ext_resource type="Script" path="res://scenes/Door_unlock.gd" id="8_vo407"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_l55pp"]
sky_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)
ground_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)

[sub_resource type="Sky" id="Sky_f6evu"]
sky_material = SubResource("ProceduralSkyMaterial_l55pp")

[sub_resource type="Environment" id="Environment_3dq5s"]
background_mode = 2
sky = SubResource("Sky_f6evu")
tonemap_mode = 3
tonemap_exposure = 1.11
ssao_enabled = true
sdfgi_enabled = true
glow_enabled = true
fog_density = 0.0
volumetric_fog_enabled = true
volumetric_fog_density = 0.0294
volumetric_fog_albedo = Color(0.337255, 0.74902, 1, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_id3mo"]
albedo_texture = ExtResource("2_umbrl")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_eugje"]
albedo_texture = ExtResource("1_j6pm3")
uv1_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_xvcf8"]
albedo_color = Color(0, 1, 1, 1)
metallic = 1.0
roughness = 0.33
emission = Color(1, 1, 1, 1)
emission_energy_multiplier = 3.14
backlight = Color(0.690196, 1, 1, 1)

[sub_resource type="SphereShape3D" id="SphereShape3D_jpknm"]
radius = 0.8

[sub_resource type="BoxShape3D" id="BoxShape3D_2e6rv"]
size = Vector3(1, 1, 1.94209)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_dka6n"]
albedo_texture = ExtResource("8_3qtlm")
uv1_scale = Vector3(3, 3, 3)

[sub_resource type="BoxMesh" id="BoxMesh_e4uw7"]
size = Vector3(1, 2, 0.1)

[sub_resource type="BoxShape3D" id="BoxShape3D_golnm"]
size = Vector3(1, 2, 0.1)

[node name="Main_scene" type="Node3D"]

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_3dq5s")

[node name="City_Scene" parent="WorldEnvironment" instance=ExtResource("1_ct7o4")]
transform = Transform3D(359.687, 0, 0, 0, 359.687, 0, 0, 0, 359.687, 0, -16.3865, 0)

[node name="Mountain_mesh" parent="WorldEnvironment/City_Scene" index="0"]
material_override = SubResource("StandardMaterial3D_id3mo")

[node name="CSGCombiner3D" type="CSGCombiner3D" parent="WorldEnvironment"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.505973, 0)
visible = false
use_collision = true

[node name="CSGBox3D" type="CSGBox3D" parent="WorldEnvironment/CSGCombiner3D"]
size = Vector3(546.207, 1, 617.783)
material = SubResource("StandardMaterial3D_eugje")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866024, -0.433016, 0.250001, 0, 0.499998, 0.866026, -0.500003, 0.749999, -0.43301, -16.9281, 7.82297, 4.11218)
light_color = Color(0.901961, 0.321569, 0, 1)
light_energy = 0.78
shadow_enabled = true

[node name="PlayerTemplate" parent="." instance=ExtResource("2_yn66j")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.35398, 4.28353, -13.2349)
collision_mask = 2

[node name="Skeleton3D" parent="PlayerTemplate/lowPolyBasemesh_rig_anim/rig" index="0"]
bones/0/position = Vector3(0.0158854, 0.905799, -0.04838)
bones/0/rotation = Quaternion(0.125784, -0.0236358, 0.00299767, 0.991772)
bones/1/rotation = Quaternion(-0.0654566, -0.00144015, -0.0222896, 0.997606)
bones/2/rotation = Quaternion(-0.0729683, 0.00368351, -0.0108578, 0.997268)
bones/2/scale = Vector3(0.998489, 1.00305, 0.998466)
bones/3/rotation = Quaternion(0.00693621, -0.0241979, 0.065898, 0.997509)
bones/3/scale = Vector3(1.00175, 0.996423, 1.00184)
bones/4/rotation = Quaternion(0.441612, 0.0109123, -0.0236345, 0.896829)
bones/5/rotation = Quaternion(-0.346018, 0.0103701, -0.00382483, 0.938163)
bones/6/rotation = Quaternion(-0.0441498, 0.0283794, -0.0258686, 0.998287)
bones/7/position = Vector3(0.0158854, 0.905799, -0.04838)
bones/7/rotation = Quaternion(-0.0772169, -0.763535, -0.385001, 0.512666)
bones/8/position = Vector3(0.0158853, 0.905799, -0.04838)
bones/8/rotation = Quaternion(-0.0954694, 0.738246, 0.380885, 0.548456)
bones/9/position = Vector3(0.103182, 0.962358, -0.00518964)
bones/9/rotation = Quaternion(0.997797, 0.0161782, 0.0476847, 0.0431903)
bones/9/scale = Vector3(1.00404, 0.991965, 1.00404)
bones/10/rotation = Quaternion(-3.93382e-08, -0.00117462, -8.09114e-09, 0.999999)
bones/11/rotation = Quaternion(0.185722, -0.00156607, 0.000293044, 0.982601)
bones/11/scale = Vector3(1.00035, 0.997626, 1.00207)
bones/12/rotation = Quaternion(4.6863e-08, -0.0111407, 1.8159e-08, 0.999938)
bones/13/rotation = Quaternion(-0.554571, -0.0801394, -0.0236508, 0.827931)
bones/13/scale = Vector3(0.996118, 0.996916, 1.00704)
bones/14/rotation = Quaternion(-0.0489894, 0.942391, -0.330646, -0.0131629)
bones/14/scale = Vector3(0.999918, 1.00008, 1)
bones/15/position = Vector3(-0.0751668, 0.962397, -0.0136719)
bones/15/rotation = Quaternion(0.995818, -0.0482848, -0.000499137, 0.077556)
bones/15/scale = Vector3(1.00338, 0.993263, 1.00338)
bones/16/rotation = Quaternion(-5.30865e-08, 3.26044e-05, -1.15855e-08, 1)
bones/17/rotation = Quaternion(0.166481, -0.000335112, 5.6177e-05, 0.986045)
bones/17/scale = Vector3(1.00017, 0.999119, 1.00072)
bones/18/rotation = Quaternion(8.57415e-09, -0.0244003, -7.73953e-09, 0.999702)
bones/19/rotation = Quaternion(-0.56341, 0.0445403, 0.0195183, 0.824745)
bones/19/scale = Vector3(0.996761, 0.997141, 1.00615)
bones/20/rotation = Quaternion(0.0260371, 0.95501, -0.295317, 0.00805879)
bones/21/position = Vector3(0.0322546, 1.44778, 0.0684281)
bones/21/rotation = Quaternion(-0.582535, -0.392772, -0.357086, 0.615526)
bones/22/position = Vector3(0.200657, 1.44148, -0.00528468)
bones/22/rotation = Quaternion(-0.0381296, -0.0932432, 0.99291, -0.0630988)
bones/22/scale = Vector3(1.00895, 0.982335, 1.00895)
bones/23/rotation = Quaternion(-5.69159e-08, 0.0374751, 3.90504e-08, 0.999298)
bones/24/rotation = Quaternion(0.234205, 0.0373688, -0.00885099, 0.971429)
bones/24/scale = Vector3(0.999937, 0.994667, 1.00566)
bones/25/rotation = Quaternion(2.506e-08, -0.024971, 2.19152e-08, 0.999688)
bones/26/rotation = Quaternion(-0.149905, -0.0248171, 0.0719581, 0.985766)
bones/26/scale = Vector3(0.991839, 1.01492, 0.993536)
bones/28/rotation = Quaternion(0.111657, 0.00134685, -0.0154407, 0.993626)
bones/29/rotation = Quaternion(0.15221, 0.000305535, 0.0312851, 0.987853)
bones/35/rotation = Quaternion(0.0922491, 4.51948e-05, -0.000664716, 0.995736)
bones/36/rotation = Quaternion(0.122754, 1.62869e-05, 0.00132782, 0.992436)
bones/39/rotation = Quaternion(0.0833014, 0.00216309, -0.0369355, 0.995837)
bones/40/rotation = Quaternion(0.108863, 0.00115435, 0.07078, 0.991533)
bones/43/rotation = Quaternion(0.108591, -0.00237231, 0.0281917, 0.993684)
bones/44/rotation = Quaternion(0.189027, 0.00217379, -0.072805, 0.979267)
bones/46/position = Vector3(-0.000853989, 1.44564, 0.0658215)
bones/46/rotation = Quaternion(-0.634116, 0.302583, 0.349748, 0.619691)
bones/47/position = Vector3(-0.15316, 1.41772, -0.0336279)
bones/47/rotation = Quaternion(-0.0448432, -0.133768, 0.983391, 0.114181)
bones/47/scale = Vector3(1.01349, 0.973571, 1.01349)
bones/48/rotation = Quaternion(2.62598e-09, -0.0412187, -1.48891e-08, 0.99915)
bones/49/rotation = Quaternion(0.388592, -0.0413591, 0.017296, 0.920319)
bones/49/scale = Vector3(0.999976, 0.980284, 1.02096)
bones/50/rotation = Quaternion(8.368e-08, -0.0480736, -4.39965e-08, 0.998844)
bones/51/rotation = Quaternion(0.016232, -0.0482065, -0.0286182, 0.998295)
bones/51/scale = Vector3(0.986953, 1.02676, 0.986827)
bones/53/rotation = Quaternion(0.519536, 0.00527842, 0.0145743, 0.854308)
bones/54/rotation = Quaternion(0.553892, -0.0134456, -0.0282484, 0.832001)
bones/60/rotation = Quaternion(0.50282, 0.000238862, 0.000623297, 0.864391)
bones/61/rotation = Quaternion(0.529101, -0.000573412, -0.00119935, 0.848558)
bones/64/rotation = Quaternion(0.494746, 0.0135852, 0.0344156, 0.86825)
bones/65/rotation = Quaternion(0.516122, -0.0308416, -0.0637179, 0.853585)
bones/68/rotation = Quaternion(0.516781, -0.00971529, -0.0265705, 0.85565)
bones/69/rotation = Quaternion(0.583674, 0.0286744, 0.0669564, 0.808714)
bones/71/position = Vector3(0.140302, 1.32359, -0.0321289)
bones/71/rotation = Quaternion(-0.0519489, 0.70059, 0.711658, 0.00421283)
bones/72/position = Vector3(-0.0741984, 1.3092, -0.0493119)
bones/72/rotation = Quaternion(-0.0519489, 0.70059, 0.711658, 0.00421283)

[node name="HandBone" parent="PlayerTemplate/lowPolyBasemesh_rig_anim/rig/Skeleton3D" index="0"]
transform = Transform3D(0.267735, 0.117864, 0.956099, 0.579618, -0.789836, -0.0711185, 0.760972, 0.612506, -0.291109, -0.243813, 0.916499, 0.0753746)

[node name="OmniLight3D" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5.16949, 12.8763, -4.9121)
light_color = Color(0, 0.466667, 0.27451, 1)
light_energy = 9.686
light_volumetric_fog_energy = 10.029
omni_range = 7.15987

[node name="SpotLight3D" type="SpotLight3D" parent="OmniLight3D"]
transform = Transform3D(1, 0, 0, 0, 0.188924, 0.981992, 0, -0.981992, 0.188924, 19.4943, 0, 20.9758)
light_color = Color(0, 0.647059, 0.403922, 1)
light_energy = 14.486
light_volumetric_fog_energy = 14.485
spot_range = 15.0553
spot_angle = 14.6177

[node name="OmniLight3D2" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 14.1818, 17.7904, 36.876)
light_color = Color(0, 0.466667, 0.27451, 1)
light_energy = 16.0
light_volumetric_fog_energy = 4.397
omni_range = 12.4707

[node name="Drzwi_area" parent="." instance=ExtResource("3_e0d1d")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.80147, -0.0622239, -16.2887)

[node name="Key_Item" type="Node3D" parent="."]
transform = Transform3D(0.639815, -0.766774, 0.0519104, 0, -0.0675451, -0.997716, 0.768529, 0.638353, -0.0432164, 8.55386, 0.626285, -14.576)
script = ExtResource("6_2k43v")

[node name="key" parent="Key_Item" instance=ExtResource("4_rjhu0")]

[node name="Plane" parent="Key_Item/key" index="0"]
material_override = SubResource("StandardMaterial3D_xvcf8")

[node name="PlayerDetector" type="Area3D" parent="Key_Item"]
collision_layer = 0
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="Key_Item/PlayerDetector"]
shape = SubResource("SphereShape3D_jpknm")

[node name="PhysicalDoor" type="HingeJoint3D" parent="."]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0.29344, 0, -17.0321)
node_b = NodePath("RigidBody3D")
angular_limit/enable = true
angular_limit/softness = 0.09

[node name="Lock" type="Area3D" parent="PhysicalDoor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.5, 0, -1)
collision_layer = 0
script = ExtResource("6_hj6ip")

[node name="CollisionShape3D" type="CollisionShape3D" parent="PhysicalDoor/Lock"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.496536, 0)
shape = SubResource("BoxShape3D_2e6rv")

[node name="RigidBody3D" type="RigidBody3D" parent="PhysicalDoor"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0.5, 0, -1)
collision_layer = 2
mass = 500.0
freeze = true
script = ExtResource("8_vo407")

[node name="CubeMesh" type="MeshInstance3D" parent="PhysicalDoor/RigidBody3D"]
material_override = SubResource("StandardMaterial3D_dka6n")
mesh = SubResource("BoxMesh_e4uw7")

[node name="CubeShape" type="CollisionShape3D" parent="PhysicalDoor/RigidBody3D"]
shape = SubResource("BoxShape3D_golnm")

[connection signal="body_entered" from="Key_Item/PlayerDetector" to="Key_Item" method="_on_player_detector_body_entered"]
[connection signal="body_entered" from="PhysicalDoor/Lock" to="PhysicalDoor/Lock" method="_on_body_entered"]
[connection signal="unlock" from="PhysicalDoor/Lock" to="PhysicalDoor/RigidBody3D" method="_on_lock_unlock"]

[editable path="WorldEnvironment/City_Scene"]
[editable path="PlayerTemplate"]
[editable path="PlayerTemplate/lowPolyBasemesh_rig_anim"]
[editable path="Key_Item/key"]
